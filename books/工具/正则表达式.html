<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>正则表达式 | 小辉儿</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/blog/img/icon.ico">
    <link rel="stylesheet" href="/blog/css/style.css">
    <script language="javascript" type="text/javascript" src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script language="javascript" type="text/javascript" src="https://cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js"></script>
    <script language="javascript" type="text/javascript" src="/blog/js/MouseClickEffect.js"></script>
    <script src="/blog/js/index.js"></script>
    <script>var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?a231f584371cf944991a315af0111c23";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();</script>
    <script language="javascript" type="text/javascript" async="true" src="https://www.googletagmanager.com/gtag/js?id=G-C211XFBDL1">
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-C211XFBDL1');</script>
    <meta name="description" content="春夏秋冬，萬事勝意">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/blog/assets/css/0.styles.890c1ed5.css" as="style"><link rel="preload" href="/blog/assets/js/app.76af623e.js" as="script"><link rel="preload" href="/blog/assets/js/5.92edf6ae.js" as="script"><link rel="preload" href="/blog/assets/js/1.38b195b2.js" as="script"><link rel="preload" href="/blog/assets/js/25.e220121e.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.4b4e589e.js"><link rel="prefetch" href="/blog/assets/js/11.34dba913.js"><link rel="prefetch" href="/blog/assets/js/12.07e80048.js"><link rel="prefetch" href="/blog/assets/js/13.6cd6bba1.js"><link rel="prefetch" href="/blog/assets/js/14.9da1508e.js"><link rel="prefetch" href="/blog/assets/js/15.7f9add0e.js"><link rel="prefetch" href="/blog/assets/js/16.d48deed2.js"><link rel="prefetch" href="/blog/assets/js/17.36fd54fe.js"><link rel="prefetch" href="/blog/assets/js/18.97e07506.js"><link rel="prefetch" href="/blog/assets/js/19.a292059c.js"><link rel="prefetch" href="/blog/assets/js/2.f56431b6.js"><link rel="prefetch" href="/blog/assets/js/20.b54ae9ca.js"><link rel="prefetch" href="/blog/assets/js/21.a843c2e4.js"><link rel="prefetch" href="/blog/assets/js/22.f5c37fbd.js"><link rel="prefetch" href="/blog/assets/js/23.50cceba1.js"><link rel="prefetch" href="/blog/assets/js/24.61814cba.js"><link rel="prefetch" href="/blog/assets/js/26.654d8a06.js"><link rel="prefetch" href="/blog/assets/js/27.d87b73ec.js"><link rel="prefetch" href="/blog/assets/js/4.12035a31.js"><link rel="prefetch" href="/blog/assets/js/6.62850de2.js"><link rel="prefetch" href="/blog/assets/js/7.51e3de72.js"><link rel="prefetch" href="/blog/assets/js/8.c6ae5443.js"><link rel="prefetch" href="/blog/assets/js/9.3738bdba.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.890c1ed5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-9a2bb82e><div data-v-9a2bb82e><div class="password-shadow password-wrapper-out" style="display:none;" data-v-dec3c71a data-v-9a2bb82e data-v-9a2bb82e><h3 class="title" data-v-dec3c71a data-v-dec3c71a>小辉儿</h3> <p class="description" data-v-dec3c71a data-v-dec3c71a>春夏秋冬，萬事勝意</p> <label id="box" class="inputBox" data-v-dec3c71a data-v-dec3c71a><input type="password" value="" data-v-dec3c71a> <span data-v-dec3c71a>Konck! Knock!</span> <button data-v-dec3c71a>OK</button></label> <div class="footer" data-v-dec3c71a data-v-dec3c71a><span data-v-dec3c71a><i class="iconfont reco-theme" data-v-dec3c71a></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-dec3c71a>vuePress-theme-reco</a></span> <span data-v-dec3c71a><i class="iconfont reco-copyright" data-v-dec3c71a></i> <a data-v-dec3c71a><span data-v-dec3c71a>小辉儿</span>
            
          <!---->
          2022
        </a></span></div></div> <div class="hide" data-v-9a2bb82e><header class="navbar" data-v-9a2bb82e><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="/blog/img/logo.jpg" alt="小辉儿" class="logo"> <span class="site-name">小辉儿</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link"><i class="iconfont reco-home"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/categories/前端/" class="nav-link"><i class="undefined"></i>
  前端
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/工具/" class="nav-link"><i class="undefined"></i>
  工具
</a></li></ul></div></div><div class="nav-item"><a href="/blog/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/blog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间线
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-account"></i>
      关于
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/about/me.html" class="nav-link"><i class="iconfont reco-account"></i>
  关于我
</a></li><li class="dropdown-item"><!----> <a href="/blog/about/blog.html" class="nav-link"><i class="iconfont reco-blog"></i>
  关于博客
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-9a2bb82e></div> <aside class="sidebar" data-v-9a2bb82e><div class="personal-info-wrapper" data-v-a7f5f470 data-v-9a2bb82e><img src="/blog/img/avatar.jpg" alt="author-avatar" class="personal-img" data-v-a7f5f470> <h3 class="name" data-v-a7f5f470>
    小辉儿
  </h3> <div class="num" data-v-a7f5f470><div data-v-a7f5f470><h3 data-v-a7f5f470>8</h3> <h6 data-v-a7f5f470>文章</h6></div> <div data-v-a7f5f470><h3 data-v-a7f5f470>6</h3> <h6 data-v-a7f5f470>标签</h6></div></div> <ul class="social-links" data-v-a7f5f470><li class="social-item" data-v-a7f5f470><i class="iconfont reco-github" style="color:#24292f;" data-v-a7f5f470></i></li><li class="social-item" data-v-a7f5f470><i class="iconfont reco-csdn" style="color:#fc5531;" data-v-a7f5f470></i></li></ul> <hr data-v-a7f5f470></div> <nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link"><i class="iconfont reco-home"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/categories/前端/" class="nav-link"><i class="undefined"></i>
  前端
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/工具/" class="nav-link"><i class="undefined"></i>
  工具
</a></li></ul></div></div><div class="nav-item"><a href="/blog/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/blog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间线
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-account"></i>
      关于
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/about/me.html" class="nav-link"><i class="iconfont reco-account"></i>
  关于我
</a></li><li class="dropdown-item"><!----> <a href="/blog/about/blog.html" class="nav-link"><i class="iconfont reco-blog"></i>
  关于博客
</a></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>工具</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/books/工具/git基础教程.html" class="sidebar-link">git 基础教程</a></li><li><a href="/blog/books/工具/yaml介绍.html" class="sidebar-link">yaml 介绍</a></li><li><a href="/blog/books/工具/正则表达式.html" class="active sidebar-link">正则表达式</a></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-dec3c71a data-v-9a2bb82e><h3 class="title" data-v-dec3c71a data-v-dec3c71a>正则表达式</h3> <!----> <label id="box" class="inputBox" data-v-dec3c71a data-v-dec3c71a><input type="password" value="" data-v-dec3c71a> <span data-v-dec3c71a>Konck! Knock!</span> <button data-v-dec3c71a>OK</button></label> <div class="footer" data-v-dec3c71a data-v-dec3c71a><span data-v-dec3c71a><i class="iconfont reco-theme" data-v-dec3c71a></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-dec3c71a>vuePress-theme-reco</a></span> <span data-v-dec3c71a><i class="iconfont reco-copyright" data-v-dec3c71a></i> <a data-v-dec3c71a><span data-v-dec3c71a>小辉儿</span>
            
          <!---->
          2022
        </a></span></div></div> <div data-v-9a2bb82e><main class="page"><section><div class="page-title"><h1 class="title">正则表达式</h1> <div data-v-0eb969a1><i class="iconfont reco-account" data-v-0eb969a1><span data-v-0eb969a1>小辉儿</span></i> <i class="iconfont reco-date" data-v-0eb969a1><span data-v-0eb969a1>2022/4/10</span></i> <!----> <i class="tags iconfont reco-tag" data-v-0eb969a1><span class="tag-item" data-v-0eb969a1>js</span><span class="tag-item" data-v-0eb969a1>正则</span></i></div></div> <div class="theme-reco-content content__default"><blockquote><ul><li>正则表达式不要背：https://juejin.cn/post/6844903845227659271</li> <li>正则表达式验证网站：https://regex101.com/</li></ul></blockquote> <p>正则表达式是一种<strong>用来描述规则的表达式</strong>。其底层原理就是使用状态机的思想进行模式匹配。</p> <p>正则表达式的基本组成元素：</p> <ul><li><strong>字符：</strong> 通常就是正则表达式里面使用的就是数字、英文字母</li> <li><strong>元字符：</strong> 也被称为特殊字符，是一些用来表示特殊语义的字符。如<code>^</code>表示非，<code>|</code>表示或，等。利用这些元字符，才能构造出强大的表达式模式(pattern)。</li></ul> <h1 id="_1-从字符出发"><a href="#_1-从字符出发" class="header-anchor">#</a> 1 从字符出发</h1> <h2 id="_1-1-单个字符"><a href="#_1-1-单个字符" class="header-anchor">#</a> 1.1 单个字符</h2> <p>最简单的正则表达式可以由简单的数字和字母组成，没有特殊的语义，纯粹就是一一对应的关系。如想在<code>apple</code>这个单词里找到<code>a</code>这个字符，就直接用<code>/a/</code>这个正则就可以了。</p> <p>但是如果想要匹配特殊字符的话，就得请出我们第一个元字符<code>\</code>， 它是<strong>转义字符</strong>字符，顾名思义，就是<strong>让其后续的字符失去其本来的含义</strong>。举个例子：</p> <p>我想匹配<code>*</code>这个符号，由于<code>*</code>这个符号本身是个特殊字符，所以我要利用转义元字符<code>\</code>来让它失去其本来的含义：</p> <div class="language-code line-numbers-mode"><pre class="language-text"><code>/\*/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>如果本来这个字符不是特殊字符，使用转义符号就会让它拥有特殊的含义。我们常常需要匹配一些特殊字符，比如空格，制表符，回车，换行等，而这些就需要我们使用转义字符来匹配。为了便于记忆，我整理了下面这个表格，并附上记忆方式：</p> <table><thead><tr><th>特殊字符</th> <th>正则表达式</th> <th>记忆方式</th></tr></thead> <tbody><tr><td>换行符</td> <td><code>\n</code></td> <td><strong>n</strong>ew line</td></tr> <tr><td>换页符</td> <td><code>\f</code></td> <td><strong>f</strong>orm feed</td></tr> <tr><td>回车符</td> <td><code>\r</code></td> <td><strong>r</strong>eturn</td></tr> <tr><td>空白符</td> <td><code>\s</code></td> <td><strong>s</strong>pace</td></tr> <tr><td>制表符</td> <td><code>\t</code></td> <td><strong>t</strong>ab</td></tr> <tr><td>垂直制表符</td> <td><code>\v</code></td> <td><strong>v</strong>ertical tab</td></tr> <tr><td>回退符</td> <td><code>[\b]</code></td> <td><strong>b</strong>ackspace，之所以使用<code>[]</code>符号是避免和<code>\b</code>重复</td></tr></tbody></table> <h2 id="_1-2-多个字符"><a href="#_1-2-多个字符" class="header-anchor">#</a> 1.2 多个字符</h2> <p>单个字符的映射关系是一对一的，即正则表达式被用来筛选匹配的字符只有一个。而这显然是不够的，只要引入<strong>集合区间</strong>和<strong>通配符</strong>的方式就可以实现<strong>一对多</strong>的匹配了。</p> <p>在正则表达式里，<strong>集合的定义方式</strong>是使用中括号<code>[</code>和<code>]</code>。如<code>/[123]/</code>这个正则就能同时匹配<code>1,2,3</code>三个字符。那如果我想匹配所有的数字怎么办呢？从 0 写到 9 显然太过低效，所以元字符<code>-</code>就可以用来表示区间范围，利用<code>/[0-9]/</code>就能匹配所有的数字, <code>/[a-z]/</code>则可以匹配所有的英文小写字母。</p> <p>即便有了集合和区间的定义方式，如果要同时匹配多个字符也还是要一一列举，这是低效的。所以在正则表达式里衍生了一批用来同时匹配多个字符的简便正则表达式：</p> <table><thead><tr><th>匹配区间</th> <th>正则表达式</th> <th>记忆方式</th></tr></thead> <tbody><tr><td>除了换行符之外的任何字符</td> <td><code>.</code></td> <td>句号，除了句子结束符</td></tr> <tr><td>单个数字，<code>[0-9]</code></td> <td><code>\d</code></td> <td><strong>d</strong>igit</td></tr> <tr><td>除了 <code>[0-9]</code></td> <td><code>\D</code></td> <td><strong>not</strong> <strong>d</strong>igit</td></tr> <tr><td>包括下划线在内的单个字符，<code>[A-Z a-z 0-9 _]</code></td> <td><code>\w</code></td> <td><strong>w</strong>ord</td></tr> <tr><td>非单字字符</td> <td><code>\W</code></td> <td><strong>not</strong> <strong>w</strong>ord</td></tr> <tr><td>匹配空白字符，包括空格、制表符、换页符和换行符</td> <td><code>\s</code></td> <td><strong>s</strong>pace</td></tr> <tr><td>匹配非空白字符</td> <td><code>\S</code></td> <td><strong>not</strong> <strong>s</strong>pace</td></tr></tbody></table> <h1 id="_2-循环与重复"><a href="#_2-循环与重复" class="header-anchor">#</a> 2 循环与重复</h1> <p>一对一和一对多的字符匹配都讲完了。接下来，就该介绍如何同时匹配多个字符。要实现多个字符的匹配我们只要多次循环，重复使用我们的之前的正则规则就可以了。那么根据循环次数的多与少，我们可以分为 0 次，1 次，多次，特定次。</p> <h2 id="_0-1"><a href="#_0-1" class="header-anchor">#</a> 0 | 1</h2> <p>元字符<code>?</code>代表了匹配 1 个字符或 0 个字符。设想一下，如果你要匹配<code>color</code>和<code>colour</code>这两个单词，就需要同时保证<code>u</code>这个字符是否出现都能被匹配到。所以你的正则表达式应该是这样的：<code>/colou?r/</code>。</p> <h2 id="_0"><a href="#_0" class="header-anchor">#</a> &gt;= 0</h2> <p>元字符<code>*</code>用来表示匹配 0 个字符或无数个字符。通常用来过滤某些可有可无的字符串。</p> <h2 id="_1"><a href="#_1" class="header-anchor">#</a> &gt;= 1</h2> <p>元字符<code>+</code>适用于要匹配同个字符出现 1 次或多次的情况。</p> <h2 id="特定次数"><a href="#特定次数" class="header-anchor">#</a> 特定次数</h2> <p>在某些情况下，我们需要匹配特定的重复次数，元字符<code>{</code>和<code>}</code>用来给重复匹配设置精确的区间范围。如<code>a</code>我想匹配 3 次，那么我就使用<code>/a{3}/</code>这个正则，或者说<code>a</code>我想匹配至少两次就是用<code>/a{2,}/</code>这个正则。</p> <p>以下是完整的语法：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>- {x}: x次
- {min, max}： 介于min次到max次之间
- {min, }: 至少min次
- {0, max}： 至多max次
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>由于这些元字符比较抽象，且容易混淆，所以我用了联想记忆的方式编了口诀能保证在用到的时候就能回忆起来。</p> <table><thead><tr><th>匹配规则</th> <th>元字符</th> <th>联想方式</th></tr></thead> <tbody><tr><td>0 次或 1 次</td> <td><code>?</code></td> <td>且<strong>问</strong>，此事<strong>有</strong>还<strong>无</strong></td></tr> <tr><td>0 次或无数次</td> <td><code>*</code></td> <td>宇宙洪荒,<strong>辰宿</strong>列张：宇宙伊始，从无到有，最后星宿布满星空</td></tr> <tr><td>1 次或无数次</td> <td><code>+</code></td> <td><strong>一加</strong>，+1</td></tr> <tr><td>特定次数</td> <td><code>{x}, {min, max}</code></td> <td>可以想象成一个数轴，从一个点，到一个射线再到线段。min 和 max 分别表示了左闭右闭区间的左界和右界</td></tr></tbody></table> <h1 id="_3-位置边界"><a href="#_3-位置边界" class="header-anchor">#</a> 3 位置边界</h1> <p>上面我们把字符的匹配都介绍完了，接着我们还需要位置边界的匹配。在长文本字符串查找过程中，我们常常需要限制查询的位置。比如我只想在单词的开头结尾查找。</p> <h2 id="_3-1-单词边界"><a href="#_3-1-单词边界" class="header-anchor">#</a> 3.1 单词边界</h2> <p>单词是构成句子和文章的基本单位，一个常见的使用场景是把文章或句子中的特定单词找出来。如：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>The cat scattered his food all over the room.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>我想找到<code>cat</code>这个单词，但是如果只是使用<code>/cat/</code>这个正则，就会同时匹配到<code>cat</code>和<code>scattered</code>这两处文本。这时候我们就需要使用边界正则表达式<code>\b</code>，其中 b 是 boundary 的首字母。在正则引擎里它其实匹配的是能构成单词的字符<code>\w</code>和不能构成单词的字符<code>\W</code>中间的那个位置。</p> <p>上面的例子改写成<code>/\bcat\b/</code>这样就能匹配到<code>cat</code>这个单词了。</p> <h2 id="_3-2-字符串边界"><a href="#_3-2-字符串边界" class="header-anchor">#</a> 3.2 字符串边界</h2> <p>匹配完单词，我们再来看一下一整个字符串的边界怎么匹配。元字符<code>^</code>用来匹配字符串的开头。而元字符<code>$</code>用来匹配字符串的末尾。注意的是在长文本里，如果要排除换行符的干扰，我们要使用多行模式。试着匹配<code>I am scq000</code>这个句子：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>I am scq000.
I am scq000.
I am scq000.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>我们可以使用<code>/^I am scq000\.$/m</code>这样的正则表达式，其实 m 是 multiple line 的首字母。正则里面的模式除了 m 外比较常用的还有 i 和 g 。前者的意思是忽略大小写，后者的意思是找到所有符合的匹配。</p> <p>最后，总结一下：</p> <table><thead><tr><th>边界和标志</th> <th>正则表达式</th> <th>记忆方式</th></tr></thead> <tbody><tr><td>单词边界</td> <td><code>\b</code></td> <td><strong>b</strong>oundary</td></tr> <tr><td>非单词边界</td> <td><code>\B</code></td> <td><strong>not</strong> <strong>b</strong>oundary</td></tr> <tr><td>字符串开头</td> <td><code>^</code></td> <td>小<strong>头尖尖</strong>那么大个</td></tr> <tr><td>字符串结尾</td> <td><code>$</code></td> <td><strong>终结</strong>者，美国科幻电影，美元符$</td></tr> <tr><td>多行模式</td> <td><code>m</code>标志</td> <td><strong>m</strong>ultiple of lines</td></tr> <tr><td>忽略大小写</td> <td><code>i</code>标志</td> <td><strong>i</strong>gnore case, case-<strong>i</strong>nsensitive</td></tr> <tr><td>全局模式</td> <td><code>g</code>标志</td> <td><strong>g</strong>lobal</td></tr></tbody></table> <h1 id="_4-子表达式"><a href="#_4-子表达式" class="header-anchor">#</a> 4 子表达式</h1> <p>字符匹配我们介绍的差不多了，更加高级的用法就得用到子表达式了。通过<strong>嵌套递归</strong>和<strong>自身引用</strong>可以让正则发挥更强大的功能。</p> <p>从简单到复杂的正则表达式演变通常要采用<strong>分组、回溯引用和逻辑处理</strong>的思想。利用这三种规则，可以推演出无限复杂的正则表达式。</p> <h2 id="_4-1-分组"><a href="#_4-1-分组" class="header-anchor">#</a> 4.1 分组</h2> <p>其中分组体现在：所有以<code>(</code>和<code>)</code>元字符所包含的正则表达式被分为一组，每一个分组都是一个<strong>子表达式</strong>，它也是构成高级正则表达式的基础。如果只是使用简单的<code>(regex)</code>匹配语法本质上和不分组是一样的，如果要发挥它强大的作用，往往要结合回溯引用的方式。</p> <h2 id="_4-2-回溯引用"><a href="#_4-2-回溯引用" class="header-anchor">#</a> 4.2 回溯引用</h2> <p>所谓回溯引用（backreference）指的是模式的后面部分引用前面已经匹配到的子字符串。你可以把它想象成是变量，回溯引用的语法像<code>\1</code>,<code>\2</code>,....,其中<code>\1</code>表示引用的第一个子表达式，<code>\2</code>表示引用的第二个子表达式，以此类推。而<code>\0</code>则表示整个表达式。</p> <p>假设现在要在下面这个文本里匹配两个连续相同的单词，你要怎么做呢？</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Hello what what is the first thing, and I am am scq000.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>利用回溯引用，我们可以很容易地写出<code>\b(\w+)\s\1</code>这样的正则。</p> <p>回溯引用在替换字符串中十分常用，语法上有些许区别，用<code>$1</code>,<code>$2</code>...来引用要被替换的字符串。下面以 js 代码作演示：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">'abc abc 123'</span><span class="token punctuation">;</span>
str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(ab)c</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span><span class="token string">'$1g'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 得到结果 'abg abg 123'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>如果我们不想子表达式被引用，可以使用<strong>非捕获</strong>正则<code>(?:regex)</code>这样就可以避免浪费内存。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">'scq000'</span><span class="token punctuation">;</span>
str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(scq00)(?:0)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token string">'$1,$2'</span><span class="token punctuation">)</span>
<span class="token comment">// 返回scq00,$2</span>
<span class="token comment">// 由于使用了非捕获正则，所以第二个引用没有值，这里直接替换为$2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>有时，我们需要限制回溯引用的适用范围。那么通过前向查找和后向查找就可以达到这个目的。</p> <h3 id="_4-3-前向查找"><a href="#_4-3-前向查找" class="header-anchor">#</a> 4.3 前向查找</h3> <p>前向查找(lookahead)是用来限制后缀的。凡是以<code>(?=regex)</code>包含的子表达式在匹配过程中都会用来限制前面的表达式的匹配。例如<code>happy happily</code>这两个单词，我想获得以<code>happ</code>开头的副词，那么就可以使用<code>happ(?=ily)</code>来匹配。如果我想过滤所有以<code>happ</code>开头的副词，那么也可以采用<strong>负前向查找</strong>的正则<code>happ(?!ily)</code>，就会匹配到<code>happy</code>单词的<code>happ</code>前缀。</p> <h3 id="_4-4-后向查找"><a href="#_4-4-后向查找" class="header-anchor">#</a> 4.4 后向查找</h3> <p>介绍完前向查找，接着我们再来介绍一下它的反向操作：后向查找(lookbehind)。后向查找(lookbehind)是通过指定一个子表达式，然后从符合这个子表达式的位置出发开始查找符合规则的字串。举个简单的例子： <code>apple</code>和<code>people</code>都包含<code>ple</code>这个后缀，那么如果我只想找到<code>apple</code>的<code>ple</code>，该怎么做呢？我们可以通过限制<code>app</code>这个前缀，就能唯一确定<code>ple</code>这个单词了。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>/(?&lt;=app)ple/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>其中<code>(?&lt;=regex)</code>的语法就是我们这里要介绍的后向查找。<code>regex</code>指代的子表达式会作为限制项进行匹配，匹配到这个子表达式后，就会继续向<strong>后</strong>查找。另外一种限制匹配是利用<code>(?&lt;!regex)</code> 语法，这里称为<strong>负后向查找</strong>。与正前向查找不同的是，被指定的子表达式不能被匹配到。于是，在上面的例子中，如果想要查找<code>apple</code>的<code>ple</code>也可以这么写成<code>/(?&lt;!peo)ple</code>。</p> <p>需要注意的，不是每种正则实现都支持后向查找。在 javascript 中是不支持的，所以如果有用到后向查找的情况，有一个思路是将字符串进行翻转，然后再使用前向查找，作完处理后再翻转回来。看一个简单的例子：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 比如我想替换apple的ple为ply</span>
<span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">'apple people'</span><span class="token punctuation">;</span>
str<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">elp(?=pa)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token string">'ylp'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><blockquote><p>ps: 感谢评论区提醒，从es2018之后，chrome中的正则表达式也支持反向查找了。不过，在实际项目中还需要注意对旧浏览器的支持，以防线上出现Bug。详情请查看http://kangax.github.io/compat-table/es2016plus/#test-RegExp_Lookbehind_Assertions</p></blockquote> <p>最后回顾一下这部分内容：</p> <table><thead><tr><th>回溯查找</th> <th>正则</th> <th>记忆方式</th></tr></thead> <tbody><tr><td>引用</td> <td><code>\0,\1,\2 和 $0, $1, $2</code></td> <td>转义+数字</td></tr> <tr><td>非捕获组</td> <td><code>(?:)</code></td> <td>引用表达式(()), 本身不被消费(?),引用(😃</td></tr> <tr><td>前向查找</td> <td><code>(?=)</code></td> <td>引用子表达式(())，本身不被消费(?), 正向的查找(=)</td></tr> <tr><td>前向负查找</td> <td><code>(?!)</code></td> <td>引用子表达式(())，本身不被消费(?), 负向的查找(!)</td></tr> <tr><td>后向查找</td> <td><code>(?&lt;=)</code></td> <td>引用子表达式(())，本身不被消费(?), 后向的(&lt;，开口往后)，正的查找(=)</td></tr> <tr><td>后向负查找</td> <td><code>(?&lt;!)</code></td> <td>引用子表达式(())，本身不被消费(?), 后向的(&lt;，开口往后)，负的查找(!)</td></tr></tbody></table> <h2 id="_4-5-逻辑处理"><a href="#_4-5-逻辑处理" class="header-anchor">#</a> 4.5 逻辑处理</h2> <p>计算机科学就是一门包含逻辑的科学。让我们回忆一下编程语言当中用到的三种逻辑关系，与或非。</p> <p>在正则里面，默认的正则规则都是<strong>与</strong>的关系所以这里不讨论。</p> <p>而<strong>非</strong>关系，分为两种情况：一种是字符匹配，另一种是子表达式匹配。在字符匹配的时候，需要使用<code>^</code>这个元字符。在这里要着重记忆一下：<strong>只有在<code>[</code>和<code>]</code>内部使用的<code>^</code>才表示非的关系</strong>。子表达式匹配的非关系就要用到前面介绍的前向负查找子表达式<code>(?!regex)</code>或后向负查找子表达式<code>(?&lt;!regex)</code>。</p> <p>或关系，通常给子表达式进行归类使用。比如，我同时匹配 a，b 两种情况就可以使用<code>(a|b)</code>这样的子表达式。</p> <table><thead><tr><th>逻辑关系</th> <th>正则元字符</th></tr></thead> <tbody><tr><td>与</td> <td>无</td></tr> <tr><td>非</td> <td><code>[^regex]</code>和<code>!</code></td></tr> <tr><td>或</td> <td><code>|</code></td></tr></tbody></table> <h1 id="_5-总结"><a href="#_5-总结" class="header-anchor">#</a> 5 总结</h1> <p>对于正则来说，符号之抽象往往让很多程序员却步。针对不好记忆的特点，我通过分类和联想的方式努力让其变得有意义。我们先从一对一的单字符，再到多对多的子字符串介绍，然后通过分组、回溯引用和逻辑处理的方式来构建高级的正则表达式。</p> <p>在最后，出个常用的正则面试题吧：请写出一个正则来处理数字千分位，如<code>12345</code>替换为<code>12,345</code>。请尝试自己推理演绎得出答案，而不是依靠搜索引擎。</p></div></section> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后更新时间: </span> <span class="time">2022/4/13 下午4:58:00</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/blog/books/工具/yaml介绍.html" class="prev">
            yaml 介绍
          </a></span> <!----></p></div> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-73918d74><li class="level-2" data-v-73918d74><a href="/blog/books/%E5%B7%A5%E5%85%B7/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F.html#_1-1-单个字符" class="sidebar-link reco-side-_1-1-单个字符" data-v-73918d74>1.1 单个字符</a></li><li class="level-2" data-v-73918d74><a href="/blog/books/%E5%B7%A5%E5%85%B7/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F.html#_1-2-多个字符" class="sidebar-link reco-side-_1-2-多个字符" data-v-73918d74>1.2 多个字符</a></li><li class="level-2" data-v-73918d74><a href="/blog/books/%E5%B7%A5%E5%85%B7/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F.html#_0-1" class="sidebar-link reco-side-_0-1" data-v-73918d74>0 | 1</a></li><li class="level-2" data-v-73918d74><a href="/blog/books/%E5%B7%A5%E5%85%B7/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F.html#_0" class="sidebar-link reco-side-_0" data-v-73918d74>&gt;= 0</a></li><li class="level-2" data-v-73918d74><a href="/blog/books/%E5%B7%A5%E5%85%B7/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F.html#_1" class="sidebar-link reco-side-_1" data-v-73918d74>&gt;= 1</a></li><li class="level-2" data-v-73918d74><a href="/blog/books/%E5%B7%A5%E5%85%B7/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F.html#特定次数" class="sidebar-link reco-side-特定次数" data-v-73918d74>特定次数</a></li><li class="level-2" data-v-73918d74><a href="/blog/books/%E5%B7%A5%E5%85%B7/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F.html#_3-1-单词边界" class="sidebar-link reco-side-_3-1-单词边界" data-v-73918d74>3.1 单词边界</a></li><li class="level-2" data-v-73918d74><a href="/blog/books/%E5%B7%A5%E5%85%B7/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F.html#_3-2-字符串边界" class="sidebar-link reco-side-_3-2-字符串边界" data-v-73918d74>3.2 字符串边界</a></li><li class="level-2" data-v-73918d74><a href="/blog/books/%E5%B7%A5%E5%85%B7/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F.html#_4-1-分组" class="sidebar-link reco-side-_4-1-分组" data-v-73918d74>4.1 分组</a></li><li class="level-2" data-v-73918d74><a href="/blog/books/%E5%B7%A5%E5%85%B7/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F.html#_4-2-回溯引用" class="sidebar-link reco-side-_4-2-回溯引用" data-v-73918d74>4.2 回溯引用</a></li><li class="level-3" data-v-73918d74><a href="/blog/books/%E5%B7%A5%E5%85%B7/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F.html#_4-3-前向查找" class="sidebar-link reco-side-_4-3-前向查找" data-v-73918d74>4.3 前向查找</a></li><li class="level-3" data-v-73918d74><a href="/blog/books/%E5%B7%A5%E5%85%B7/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F.html#_4-4-后向查找" class="sidebar-link reco-side-_4-4-后向查找" data-v-73918d74>4.4 后向查找</a></li><li class="level-2" data-v-73918d74><a href="/blog/books/%E5%B7%A5%E5%85%B7/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F.html#_4-5-逻辑处理" class="sidebar-link reco-side-_4-5-逻辑处理" data-v-73918d74>4.5 逻辑处理</a></li></ul></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-a008c6ba data-v-a008c6ba><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-a008c6ba><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-a008c6ba></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-a008c6ba></path></svg></div><div></div><!----><div></div></div></div>
    <script src="/blog/assets/js/app.76af623e.js" defer></script><script src="/blog/assets/js/5.92edf6ae.js" defer></script><script src="/blog/assets/js/1.38b195b2.js" defer></script><script src="/blog/assets/js/25.e220121e.js" defer></script>
  </body>
</html>
